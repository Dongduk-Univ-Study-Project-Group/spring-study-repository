## DI 컨테이너 알아보기

### 의존성
A 클래스에서 B 클래스르 사용하려면 new 키워드를 이용해 B 클래스의 인스턴스를 생성하고 B 클래스의 메서드를 사용하게 된다.
이때 B 클래스의 메서드를 변경하면 그 영향으로 A 클래스에서도 해당 메서드를 변경해야한다.
이런 관계를 'A 클래스는 B 클래스에 의존한다'라고 한다.

의존에는 두 가지 유형이 있다.
+ 클래스 의존(구현 의존)
+ 인터페이스 의존

클래스 의존에서는 사용되는 객체가 B 클래스에서 C 클래스로 변경되었을 때 이를 이용하고 있는 곳을 모두 수정해야 한다.  
수정한 부분이 늘어날수록 실수가 발생할 위험이 높아지고, 수정 작업과 수정에 의한 동작을 테스트하는 데 걸리는 시간이 기하급수적으로 늘어날 것이다.

인터페이스 의존에서는 사용되는 객체가 B 클래스에서 C 클래스로 변경되었을 때  
+ 인터페이스는 참조를 받는 유형으로 사용할 수 있으므로 변수의 이름을 변경하지 않아도 된다.  
+ 인터페이스가 선언된 메서드를 이용하면 클래스가 바뀌어도 메서드명을 변경하지 않아도 된다.

이러한 이점 때문에 클래스 의존보다 인터페이스 의존을 사용한다.

### DI 컨테이너
의존성 주입은 '의존하는 부분을 외부에서 주입하는 것'이다.
+ 의존하는 부분이란 '사용하는 객체' 클래스에 '사용되는 객체' 클래스가 작성된 상태이다.
+ 외부로부터 주입이란 '사용하는 객체' 클래스의 밖에서 '사용되는 객체' 인스턴스를 주입하는 것이다.

인스턴스 생성과 같은 작업을 프레임워크에 맡길 수 있고 그 역할을 하는 것이 DI 컨테이너이다. 
스프링 프레임워크는 임의로 구현한 클래스를 인스턴스로 만들어주는 기능을 제공한다.

### 다섯 가지 규칙
1. 인터페이스를 이용하여 의존성을 만든다.
2. 인스턴스를 명시적으로 생성하지 않는다.
   + 인스턴스 생성에 new 키워드를 사용하지 않는다.
3. 어노테이션을 클래스에 부여한다.
   + 인스턴스를 생성하려는 클래스에 인스턴스 생성 어노테이션을 부여한다.
4. 스프링 프레임워크에서 인스턴스를 생성한다.  
    + 스프링 프레임워크는 시작할 때 대상 프로젝트의 모든 패키지를 스캔한다. 이 기능을 컴포넌트 스캔(Component Scan)이라고 한다.
    + 컴포넌트 스캔 후 인스턴스 생성 어노테이션이 부여된 클래스를 추출하고 추출한 클래스의 인스턴스를 생성한다.
      + @Controller : 인스턴스 생성 지시. 스프링 MVC를 이용할 때 컨트롤러에 부여
      + @Service : 인스턴스 생성 지시. 트랜잭션 경계가 되는 도메인(서비스) 기능에 부여
      + @Repository : 인스턴스 생성 지시. 데이터베이스 액세스(리포지토리) 기능에 부여
      + @Component : 위 용도 이외의 클래스에 부여

5. 인스턴스를 이용하고 싶은 곳에 어노테이션을 부여한다.
   + 스프링 프레임워크에 의해 생성된 인스턴스를 이용하는 클래스에 참조를 받는 필드를 선언하고 필드에 @Autowired 어노테이션을 부여한다.

### 요약
+ 스프링 프레임워크는 임의로 구현한 클래스를 인스턴스화하는 기능을 제공한다(DI 컨테이너).
+ 스프링 프레임워크를 사용하는 애플리케이션은 인스턴스를 명시적으로 생성하지 않는다(new 키워드를 사용하지 않음).
+ 정해진 어노테이션(@Component 어노테이션)을 클래스에 부여하는 것으로 스프링 프레임워크가 인스턴스를 생성한다.
+ 생성된 인스턴스를 사용하고 싶은 부분에서 필드를 준비하고 주석(@Autowired 어노테이션)을 부여하면 스프링 프레임워크가 인스턴스가 필요한 것으로 판단하고 인스턴스를 주입한다.
+ 인터페이스를 이용해서 의존성을 만들고 DI를 사용하여 '사용되는 객체' 클래스를 변경하는 경우 '사용하는 객체' 클래스의 수정 없이 변경될 수 있다.

